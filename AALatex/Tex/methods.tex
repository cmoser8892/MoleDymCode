\chapter{Methods}
\begin{comment}
	0. Verlet Step
	1. Describe the Lenard Jones Potential
	2. Describe the Berendsen Thermostat
	3. Describe the Gupta 
	
\end{comment}
\begin{comment}
	Atoms are discreticed into the Postitions, Velocities and Forces 
	Second propagate the atom in the discriticed realm given constant Forces
		-> Velocity-Verlet Integration
	
	Compute Forces somehow
	-> Potentials
	LJ Potential 
	Gupta Potential
	
	Thermodynamic Effects
	Berendsen Thermostat
		->Gentle Way of resealing the Velocities
		
\end{comment}
%end general
\begin{comment}
goals of a md simulation
- determine the motion of each atom
	-> solve equation of motion 
	-> compute forces
	-> From the dirivation of the potential energy we can get the forces

- disciticed in time

\end{comment}
The goal of a molecular dynamics simulation is to determine the motion of each individual atom. For this we have to solve the equations of motion and compute the forces that affect each atom.
\begin{equation}
	\label{potentialForceEquation}
	\overrightarrow{f_{k}} = -\cfrac{\displaystyle\partial}{\displaystyle \partial \overrightarrow{r_{k}}} E_{pot}(\{\overrightarrow{r_{k}}\}) 
\end{equation}
The forces can be derived from the potential energy as shown in \ref{potentialForceEquation} \cite[cf.][]{molDymCourse}. 


\section{Integration}
\begin{comment}
- obtain force from the previous equation
- dirivation in v. r.. from the mass
- system can be discribed just by the velocity and postion of each atom
- in the simulation the positions and velocities of the individual atoms have to be tracked and updated accordingly
- most used  is the Velocity-Verlet Algorithm
\end{comment}
From the equation \ref{potentialForceEquation} we can obtain the force acting on each individual atom with it's acceleration, velocity and position as shown in  \ref{potentialForceEquationForEachAtom}. 
\begin{equation}
	\label{potentialForceEquationForEachAtom}
	\overrightarrow{f_{i}} = \cfrac{\displaystyle\partial E_{pot}}{\displaystyle \partial \overrightarrow{r_{i}}} = m_{i}\overrightarrow{a_{i}} = m_{i}\overrightarrow{\dot{v_{i}}} = m_{i}\overrightarrow{\ddot{r_{i}}}
\end{equation}
It can be seen that the system can be described just by the velocities and positions of the atoms. 
In the implementation we hold these values in a container-class to ensure that they are consecutive in  memory. This speeds up the simulation. 
\par
%to porpagate
In the next step we need to somehow propagate the simulation forward in time as a static simulation would be rather boring. For updating the positions and velocities one of the most used algorithms is the Velocity-Verlet integration. 
This scheme is often split up into two steps, the prediction shown in the equations \ref{verletPrediction1} and \ref{verletPrediction2} and the correction shown in equation \ref{verletCorrection} \cite[cf. ][]{molDymCourse}. In between the two steps the force can be updated. 
%Verlet steps
\begin{equation}
	\label{verletPrediction1}
	\overrightarrow{v_{i}}(t+\Delta t/2) = 
	\overrightarrow{v_{i}}(t) + 
	\frac{\overrightarrow{f_{i}}(t)\Delta t}{2m_{i}}
\end{equation}

\begin{equation}
	\label{verletPrediction2}
	\overrightarrow{r_{i}}(t+\Delta t) = 
	\overrightarrow{r_{i}}(t) + \overrightarrow{v_{i}}(t + \Delta t/2)\Delta t
\end{equation}

\begin{equation}
	\label{verletCorrection}
	\overrightarrow{v_{i}}(t+\Delta t) = \overrightarrow{v_{i}}(t+\Delta t/2) +
	\frac{\overrightarrow{f_{i}}(t + \Delta t)\Delta t}{2m_{i}}
\end{equation}
We could now already propagate atoms forward with a constant force, so next we have to actually model the forces affecting each atom.


\section{Lenard-Jones-Potential}
\begin{comment}
- pair potential
\end{comment}
%General Formula for the dirivation
The Lenard-Jones potential is most likely one of the more famous pair potentials. The goal is to model the Coulomb force and the Pauli repulsion. 
\begin{equation}
	V(r) = 4\epsilon\bigg[\Big(\frac{\sigma}{r}\Big)^{12}- \Big(\frac{\sigma}{r}\Big)^{6} \bigg]
\end{equation}
As shown in \ref{potentialForceEquation} we can derive the forces from the potential energy. Now we have to formulate the equation for each atom, which was done in \ref {potentialEquationAtoms}. We can get the force at the each atom if we sum up the derivative of the potential energy between atom k and all the other atoms i times the normed vector between them. 
\begin{equation}
	\label{potentialEquationAtoms}
	\overrightarrow{f_{k}} = -\frac{\partial E_{pot}}{\partial  \overrightarrow{r_{k}}}=\sum_{i}^{}\frac{\partial V}{\partial r_{ik}} \hat{r_{ik}}
\end{equation}
%Formulation of the lj potential
To implement the equation we have to derive $\delta V/ \delta r_{ik}$ analytically. This could have been done by hand, but was actually just done with python. 
%Potential derivation with python
\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
%\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{sympy} \PY{k}{as} \PY{n+nn}{sp}
\PY{k+kn}{import} \PY{n+nn}{warnings}
\PY{n}{warnings}\PY{o}{.}\PY{n}{filterwarnings}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{sp}\PY{o}{.}\PY{n}{init\PYZus{}printing}\PY{p}{(}\PY{p}{)}
\PY{n}{eps} \PY{o}{=} \PY{n}{sp}\PY{o}{.}\PY{n}{Symbol}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{e}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{sig} \PY{o}{=} \PY{n}{sp}\PY{o}{.}\PY{n}{Symbol}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{s}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{rad} \PY{o}{=} \PY{n}{sp}\PY{o}{.}\PY{n}{Symbol}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{r}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{energyRad} \PY{o}{=} \PY{l+m+mi}{4} \PY{o}{*} \PY{n}{eps} \PY{o}{*} \PY{p}{(}\PY{p}{(}\PY{n}{sig}\PY{o}{/}\PY{n}{rad}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{12} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{n}{sig}\PY{o}{/}\PY{n}{rad}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{6}\PY{p}{)}
\PY{n}{energyRad}\PY{o}{.}\PY{n}{diff}\PY{p}{(}\PY{n}{rad}\PY{p}{)}
	\end{Verbatim}
\end{tcolorbox}

With the codesnippet from above the derivative of the potential was obtained, shown in the next equation \ref{potentialEquationAtomsDirivative}.
\begin{equation}
	\label{potentialEquationAtomsDirivative}
	\frac{\partial V}{\partial r} = 4 \epsilon \left(\frac{6 \sigma^{6}}{r^{7}} - \frac{12 \sigma^{12}}{r^{13}}\right)
\end{equation}
Now we can implement those last two equations. We can even optimize it by subtracting the force that affects atom k from the forces of atom i, as they have to be the same just with the opposite direction and therefore sign. 
\par 
It can be seen that this algorithm behaves in the order O(NÂ²) with increasing numbers of atoms in the simulation. This can be reduced to a linear order O(N) if we only consider atoms up to a certain distance (cutoff-distance) around each atom. This is possible as the forces get smaller as the distance between the atoms increases. The next goal would be to generate a list witch marks neighbors that are inside this cutoff-distance. This can be done by using domain decomposition \cite[cf.][]{molDymCourse}
\section{Berendsen-Thermostat}
\begin{comment}
- couple the moleclular system to a larger heat bath
- thermostat controls the heat of the simulation so the system does not melt or evaporate
\end{comment}
Thermostats are used in molecular simulation to control the heat in the system and preventing it from melting or evaporating. A simple form of temperature control is the Berendsen-Thermostat, which rescales the temperature. 
\par
It is typically implemented by rescaling the velocities by a factor as shown in equation \ref{coupelingFunction}. 
\begin{equation}
	\label{coupelingFunction}
	\lambda = \sqrt{1 + \bigg(\frac{T_{0}}{T} -1\bigg)\frac{\Delta t}{\tau}}
\end{equation}
This can be done as the temperature is just another facet to kinetic energy and is connected via the following equation \cite[cf.][]{molDymCourse}. 
\begin{equation}
	\label{bolzmann}
	\frac{3}{2} k_{B} T = \sum_{i} \frac{1}{2} m v_{i}^2
\end{equation}

\section{Embedded-Atom Method Potentials}
\begin{comment}
- describe Units 
- better discribed in the course
- good model for metalic systems
- work with gold clusters 

\end{comment}
Embedded atom-potentials are a good model for metallic bonding in solid or liquid states for different materials. As an implementation of the potential, developed by Gupta \cite{gupta} and Cleri \& Rosato \cite{rosato}, was provided in the course \cite{molDymCourse} itself, the details are best found there.


